{
  "path": "services/api-gateway/app/models/admin_audit_log.py",
  "language": "python",
  "size": 1585,
  "last_modified": "2025-12-03T23:50:35.688Z",
  "lines": 47,
  "content": "\"\"\"\nAdmin audit log model for privileged actions.\n\nTracks sensitive administrator actions separately from general audit logs to\nprovide a focused trail for role changes and knowledge base maintenance.\n\"\"\"\n\nimport uuid\nfrom datetime import datetime, timezone\n\nfrom app.core.database import Base\nfrom sqlalchemy import Boolean, Column, DateTime, String\nfrom sqlalchemy.dialects.postgresql import JSONB, UUID\n\n\nclass AdminAuditLog(Base):\n    \"\"\"Record of admin or viewer actions within the admin surface.\"\"\"\n\n    __tablename__ = \"admin_audit_logs\"\n\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    created_at = Column(\n        DateTime(timezone=True),\n        nullable=False,\n        default=lambda: datetime.now(timezone.utc),\n    )\n\n    actor_id = Column(UUID(as_uuid=True), nullable=True, index=True)\n    actor_email = Column(String(255), nullable=True)\n    actor_role = Column(String(50), nullable=True)\n\n    action = Column(String(150), nullable=False, index=True)\n    target_type = Column(String(150), nullable=True)\n    target_id = Column(String(255), nullable=True)\n\n    success = Column(Boolean, nullable=False, default=True)\n    action_metadata = Column(JSONB, nullable=True)\n\n    request_id = Column(String(100), nullable=True, index=True)\n    ip_address = Column(String(45), nullable=True)\n\n    def __repr__(self) -> str:  # pragma: no cover - repr utility\n        return (\n            f\"<AdminAuditLog(action={self.action}, actor={self.actor_email}, \"\n            f\"target={self.target_type}:{self.target_id}, success={self.success})>\"\n        )\n"
}
