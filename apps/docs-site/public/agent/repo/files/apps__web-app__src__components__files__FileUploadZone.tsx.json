{
  "path": "apps/web-app/src/components/files/FileUploadZone.tsx",
  "language": "typescript",
  "size": 6440,
  "last_modified": "2025-11-25T09:43:39.263Z",
  "lines": 236,
  "content": "/**\n * FileUploadZone Component\n * Drag-and-drop file upload zone with file validation\n */\n\nimport { useCallback, useState } from \"react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Button } from \"@voiceassist/ui\";\n\ninterface FileUploadZoneProps {\n  onFilesSelected: (files: File[]) => void;\n  maxFiles?: number;\n  maxSizeMB?: number;\n  acceptedTypes?: string[];\n  disabled?: boolean;\n}\n\nconst DEFAULT_ACCEPTED_TYPES = [\n  \".pdf\",\n  \".txt\",\n  \".md\",\n  \".png\",\n  \".jpg\",\n  \".jpeg\",\n  \".gif\",\n  \".doc\",\n  \".docx\",\n];\n\nconst DEFAULT_MAX_SIZE_MB = 10;\n\nexport function FileUploadZone({\n  onFilesSelected,\n  maxFiles = 5,\n  maxSizeMB = DEFAULT_MAX_SIZE_MB,\n  acceptedTypes = DEFAULT_ACCEPTED_TYPES,\n  disabled = false,\n}: FileUploadZoneProps) {\n  const [isDragging, setIsDragging] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const validateFiles = useCallback(\n    (files: FileList | File[]): { valid: File[]; errors: string[] } => {\n      const fileArray = Array.from(files);\n      const valid: File[] = [];\n      const errors: string[] = [];\n\n      if (fileArray.length > maxFiles) {\n        errors.push(`Maximum ${maxFiles} files allowed`);\n        return { valid: [], errors };\n      }\n\n      fileArray.forEach((file) => {\n        // Check file size\n        const sizeMB = file.size / (1024 * 1024);\n        if (sizeMB > maxSizeMB) {\n          errors.push(`${file.name}: File too large (max ${maxSizeMB}MB)`);\n          return;\n        }\n\n        // Check file type\n        const extension = `.${file.name.split(\".\").pop()?.toLowerCase()}`;\n        if (!acceptedTypes.includes(extension)) {\n          errors.push(\n            `${file.name}: File type not allowed. Allowed: ${acceptedTypes.join(\", \")}`,\n          );\n          return;\n        }\n\n        valid.push(file);\n      });\n\n      return { valid, errors };\n    },\n    [maxFiles, maxSizeMB, acceptedTypes],\n  );\n\n  const handleDragEnter = useCallback(\n    (e: React.DragEvent) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (!disabled) {\n        setIsDragging(true);\n      }\n    },\n    [disabled],\n  );\n\n  const handleDragLeave = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    // Only set dragging to false if leaving the drop zone itself\n    if (e.currentTarget === e.target) {\n      setIsDragging(false);\n    }\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  }, []);\n\n  const handleDrop = useCallback(\n    (e: React.DragEvent) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n\n      if (disabled) return;\n\n      const files = e.dataTransfer.files;\n      if (files && files.length > 0) {\n        const { valid, errors } = validateFiles(files);\n\n        if (errors.length > 0) {\n          setError(errors[0]); // Show first error\n          setTimeout(() => setError(null), 5000);\n        }\n\n        if (valid.length > 0) {\n          onFilesSelected(valid);\n          setError(null);\n        }\n      }\n    },\n    [disabled, validateFiles, onFilesSelected],\n  );\n\n  const handleFileInput = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      const files = e.target.files;\n      if (files && files.length > 0) {\n        const { valid, errors } = validateFiles(files);\n\n        if (errors.length > 0) {\n          setError(errors[0]);\n          setTimeout(() => setError(null), 5000);\n        }\n\n        if (valid.length > 0) {\n          onFilesSelected(valid);\n          setError(null);\n        }\n      }\n\n      // Reset input\n      e.target.value = \"\";\n    },\n    [validateFiles, onFilesSelected],\n  );\n\n  return (\n    <div className=\"w-full\">\n      <div\n        onDragEnter={handleDragEnter}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onDrop={handleDrop}\n        className={`relative border-2 border-dashed rounded-lg p-6 transition-colors ${\n          disabled\n            ? \"border-neutral-200 bg-neutral-50 cursor-not-allowed\"\n            : isDragging\n              ? \"border-primary-500 bg-primary-50\"\n              : \"border-neutral-300 hover:border-neutral-400 cursor-pointer\"\n        }`}\n      >\n        <input\n          type=\"file\"\n          multiple\n          accept={acceptedTypes.join(\",\")}\n          onChange={handleFileInput}\n          disabled={disabled}\n          className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed\"\n          aria-label=\"Upload files\"\n        />\n\n        <div className=\"flex flex-col items-center justify-center text-center\">\n          {/* Icon */}\n          <div\n            className={`w-12 h-12 mb-3 rounded-full flex items-center justify-center ${\n              disabled\n                ? \"bg-neutral-200\"\n                : isDragging\n                  ? \"bg-primary-100\"\n                  : \"bg-neutral-100\"\n            }`}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth={1.5}\n              stroke=\"currentColor\"\n              className={`w-6 h-6 ${\n                disabled\n                  ? \"text-neutral-400\"\n                  : isDragging\n                    ? \"text-primary-600\"\n                    : \"text-neutral-600\"\n              }`}\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5\"\n              />\n            </svg>\n          </div>\n\n          {/* Text */}\n          <p\n            className={`text-sm font-medium mb-1 ${\n              disabled ? \"text-neutral-400\" : \"text-neutral-700\"\n            }`}\n          >\n            {isDragging ? \"Drop files here\" : \"Drop files or click to browse\"}\n          </p>\n          <p className=\"text-xs text-neutral-500\">\n            Max {maxFiles} files, {maxSizeMB}MB each\n          </p>\n          <p className=\"text-xs text-neutral-400 mt-1\">\n            {acceptedTypes.join(\", \")}\n          </p>\n        </div>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"mt-2 p-2 bg-red-50 border border-red-200 rounded-md\">\n          <p className=\"text-sm text-red-800\">{error}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n"
}
