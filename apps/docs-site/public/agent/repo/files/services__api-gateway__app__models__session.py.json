{
  "path": "services/api-gateway/app/models/session.py",
  "language": "python",
  "size": 1681,
  "last_modified": "2025-12-05T03:07:13.131Z",
  "lines": 54,
  "content": "\"\"\"\nSession model for conversation tracking\n\"\"\"\n\nimport uuid\nfrom datetime import datetime\n\nfrom app.core.database import Base\nfrom sqlalchemy import Column, DateTime, ForeignKey, Integer, String\nfrom sqlalchemy.dialects.postgresql import JSONB, UUID\nfrom sqlalchemy.orm import relationship\n\n\nclass Session(Base):\n    \"\"\"Session model for tracking conversations\"\"\"\n\n    __tablename__ = \"sessions\"\n\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    user_id = Column(\n        UUID(as_uuid=True),\n        ForeignKey(\"users.id\", ondelete=\"CASCADE\"),\n        nullable=False,\n        index=True,\n    )\n    title = Column(String(255), nullable=True)\n\n    # Organization\n    folder_id = Column(\n        UUID(as_uuid=True),\n        ForeignKey(\"conversation_folders.id\", ondelete=\"SET NULL\"),\n        nullable=True,\n        index=True,\n    )\n    archived = Column(Integer, default=0, nullable=False)  # 0 = active, 1 = archived\n\n    # Session metadata\n    context = Column(JSONB, nullable=True)  # Additional context data\n    message_count = Column(Integer, default=0, nullable=False)\n\n    # Per-conversation settings (P1 feature)\n    settings = Column(JSONB, nullable=True, default={})  # LLM mode, system prompt, voice options, etc.\n\n    # Timestamps\n    created_at = Column(DateTime, default=datetime.utcnow, nullable=False)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow, nullable=False)\n    ended_at = Column(DateTime, nullable=True)\n\n    # Relationships\n    folder = relationship(\"ConversationFolder\", back_populates=\"sessions\")\n\n    def __repr__(self):\n        return f\"<Session(id={self.id}, user_id={self.user_id})>\"\n"
}
