{
  "path": "apps/web-app/src/components/layout/AnalyticsConsentUI.tsx",
  "language": "typescript",
  "size": 3310,
  "last_modified": "2025-11-29T06:19:17.154Z",
  "lines": 80,
  "content": "import { useLocation } from \"react-router-dom\";\nimport { useAnalyticsConsent } from \"./AnalyticsOptInLayout\";\n\n/**\n * Analytics consent UI component.\n * Must be placed inside the Router and AnalyticsOptInLayout.\n * Only shows on the home page to avoid overlapping other UI.\n */\nexport function AnalyticsConsentUI() {\n  const location = useLocation();\n  const { consent, showNotice, setShowNotice, handleGrant, handleDeny } =\n    useAnalyticsConsent();\n\n  // Only show on the main dashboard page to avoid overlapping other UI\n  const isHomePage = location.pathname === \"/\" || location.pathname === \"/home\";\n  if (!isHomePage) {\n    return null;\n  }\n\n  if (showNotice) {\n    return (\n      <div className=\"fixed bottom-20 left-4 sm:bottom-4 z-40 max-w-md rounded-lg border border-neutral-200 bg-white p-4 shadow-lg dark:border-neutral-800 dark:bg-neutral-900\">\n        <div className=\"flex items-start gap-3\">\n          <div className=\"flex-1 space-y-2\">\n            <p className=\"text-sm font-semibold text-neutral-900 dark:text-neutral-50\">\n              Help us improve with anonymous analytics?\n            </p>\n            <p className=\"text-sm text-neutral-600 dark:text-neutral-300\">\n              We respect Do Not Track and never collect PHI. You can change this\n              setting anytime.\n            </p>\n          </div>\n        </div>\n        <div className=\"mt-3 flex flex-wrap gap-2\">\n          <button\n            type=\"button\"\n            onClick={handleGrant}\n            className=\"rounded-md bg-primary-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500\"\n          >\n            Allow analytics\n          </button>\n          <button\n            type=\"button\"\n            onClick={handleDeny}\n            className=\"rounded-md border border-neutral-300 px-3 py-2 text-sm font-medium text-neutral-800 hover:bg-neutral-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500 dark:border-neutral-700 dark:text-neutral-100 dark:hover:bg-neutral-800\"\n          >\n            No thanks\n          </button>\n          {consent !== \"pending\" && (\n            <button\n              type=\"button\"\n              onClick={() => setShowNotice(false)}\n              className=\"text-sm font-medium text-neutral-600 underline hover:text-neutral-900 dark:text-neutral-300 dark:hover:text-white\"\n            >\n              Close\n            </button>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  if (consent !== \"pending\") {\n    return (\n      <div className=\"fixed bottom-20 left-4 sm:bottom-4 z-30\">\n        <button\n          type=\"button\"\n          onClick={() => setShowNotice(true)}\n          className=\"rounded-full border border-neutral-300 bg-white px-4 py-2 text-xs font-medium text-neutral-700 shadow hover:bg-neutral-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500 dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-200 dark:hover:bg-neutral-800\"\n          aria-label=\"Review analytics preferences\"\n        >\n          Analytics preferences ({consent})\n        </button>\n      </div>\n    );\n  }\n\n  return null;\n}\n"
}
