{
  "path": "apps/web-app/src/components/clinical/ClinicalContextSidebar.tsx",
  "language": "typescript",
  "size": 13713,
  "last_modified": "2025-11-29T04:23:40.198Z",
  "lines": 342,
  "content": "/**\n * Clinical Context Sidebar\n * Display and edit clinical context during chat consultations\n */\n\nimport { useState } from \"react\";\nimport { Button } from \"@voiceassist/ui\";\nimport {\n  ClinicalContextPanel,\n  type ClinicalContext,\n} from \"./ClinicalContextPanel\";\n\nexport interface ClinicalContextSidebarProps {\n  isOpen: boolean;\n  onClose: () => void;\n  context: ClinicalContext;\n  onChange: (context: ClinicalContext) => void;\n}\n\nexport function ClinicalContextSidebar({\n  isOpen,\n  onClose,\n  context,\n  onChange,\n}: ClinicalContextSidebarProps) {\n  const [isEditing, setIsEditing] = useState(false);\n\n  if (!isOpen) {\n    return null;\n  }\n\n  const hasContext = Object.keys(context).some((key) => {\n    const value = context[key as keyof ClinicalContext];\n    if (Array.isArray(value)) return value.length > 0;\n    if (typeof value === \"object\" && value !== null)\n      return Object.keys(value).length > 0;\n    return Boolean(value);\n  });\n\n  const handleClear = () => {\n    if (confirm(\"Clear all clinical context?\")) {\n      onChange({});\n      setIsEditing(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 md:relative md:inset-auto md:z-auto\">\n      {/* Backdrop (mobile only) */}\n      <div\n        className=\"fixed inset-0 bg-black/50 md:hidden\"\n        onClick={onClose}\n        aria-hidden=\"true\"\n      />\n\n      {/* Sidebar */}\n      <div\n        className=\"fixed right-0 top-0 h-full w-96 bg-white dark:bg-neutral-900 border-l border-neutral-200 dark:border-neutral-700 shadow-lg md:relative md:w-80 md:shadow-none overflow-y-auto\"\n        role=\"complementary\"\n        aria-label=\"Clinical context\"\n      >\n        {/* Header */}\n        <div className=\"sticky top-0 bg-white dark:bg-neutral-900 border-b border-neutral-200 dark:border-neutral-700 px-4 py-3 flex items-center justify-between z-10\">\n          <h2 className=\"text-lg font-semibold text-neutral-900 dark:text-neutral-100\">\n            Clinical Context\n          </h2>\n          <div className=\"flex items-center gap-2\">\n            {!isEditing && hasContext && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setIsEditing(true)}\n                className=\"text-sm\"\n              >\n                Edit\n              </Button>\n            )}\n            <button\n              onClick={onClose}\n              className=\"md:hidden p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors\"\n              aria-label=\"Close clinical context sidebar\"\n            >\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={1.5}\n                stroke=\"currentColor\"\n                className=\"w-5 h-5 text-neutral-600 dark:text-neutral-400\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M6 18L18 6M6 6l12 12\"\n                />\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-4\">\n          {!hasContext && !isEditing ? (\n            // Empty state\n            <div className=\"text-center py-12\">\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={1.5}\n                stroke=\"currentColor\"\n                className=\"w-16 h-16 mx-auto mb-4 text-neutral-300\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z\"\n                />\n              </svg>\n              <p className=\"text-sm text-neutral-600 dark:text-neutral-400 mb-4\">\n                No clinical context provided\n              </p>\n              <Button onClick={() => setIsEditing(true)} size=\"sm\">\n                Add Patient Information\n              </Button>\n            </div>\n          ) : isEditing ? (\n            // Edit mode\n            <div className=\"space-y-4\">\n              <ClinicalContextPanel\n                context={context}\n                onChange={onChange}\n                onClear={handleClear}\n              />\n              <div className=\"flex justify-end gap-2 pt-4 border-t border-neutral-200\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setIsEditing(false)}\n                >\n                  Done\n                </Button>\n              </div>\n            </div>\n          ) : (\n            // View mode\n            <div className=\"space-y-4\">\n              {/* Demographics Summary */}\n              {context.demographics &&\n                Object.keys(context.demographics).length > 0 && (\n                  <div className=\"space-y-2\">\n                    <h3 className=\"text-sm font-semibold text-neutral-700 dark:text-neutral-300\">\n                      Demographics\n                    </h3>\n                    <div className=\"text-sm text-neutral-600 dark:text-neutral-400 space-y-1\">\n                      {context.demographics.age && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"font-medium\">Age:</span>\n                          <span>{context.demographics.age} years</span>\n                        </div>\n                      )}\n                      {context.demographics.gender && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"font-medium\">Gender:</span>\n                          <span className=\"capitalize\">\n                            {context.demographics.gender}\n                          </span>\n                        </div>\n                      )}\n                      {context.demographics.weight && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"font-medium\">Weight:</span>\n                          <span>{context.demographics.weight} kg</span>\n                        </div>\n                      )}\n                      {context.demographics.height && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"font-medium\">Height:</span>\n                          <span>{context.demographics.height} cm</span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n              {/* Chief Complaint */}\n              {context.chiefComplaint && (\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-sm font-semibold text-neutral-700 dark:text-neutral-300\">\n                    Chief Complaint\n                  </h3>\n                  <p className=\"text-sm text-neutral-600 dark:text-neutral-400\">\n                    {context.chiefComplaint}\n                  </p>\n                </div>\n              )}\n\n              {/* Problems */}\n              {context.problems && context.problems.length > 0 && (\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-sm font-semibold text-neutral-700 dark:text-neutral-300\">\n                    Active Problems\n                  </h3>\n                  <ul className=\"space-y-1\">\n                    {context.problems.map((problem, i) => (\n                      <li\n                        key={i}\n                        className=\"text-sm text-neutral-600 dark:text-neutral-400 flex items-start gap-2\"\n                      >\n                        <svg\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          viewBox=\"0 0 20 20\"\n                          fill=\"currentColor\"\n                          className=\"w-4 h-4 mt-0.5 flex-shrink-0 text-neutral-400\"\n                        >\n                          <path\n                            fillRule=\"evenodd\"\n                            d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z\"\n                            clipRule=\"evenodd\"\n                          />\n                        </svg>\n                        <span>{problem}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n\n              {/* Medications */}\n              {context.medications && context.medications.length > 0 && (\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-sm font-semibold text-neutral-700 dark:text-neutral-300\">\n                    Current Medications\n                  </h3>\n                  <ul className=\"space-y-1\">\n                    {context.medications.map((med, i) => (\n                      <li\n                        key={i}\n                        className=\"text-sm text-neutral-600 dark:text-neutral-400 flex items-start gap-2\"\n                      >\n                        <svg\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          viewBox=\"0 0 20 20\"\n                          fill=\"currentColor\"\n                          className=\"w-4 h-4 mt-0.5 flex-shrink-0 text-neutral-400\"\n                        >\n                          <path\n                            fillRule=\"evenodd\"\n                            d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z\"\n                            clipRule=\"evenodd\"\n                          />\n                        </svg>\n                        <span>{med}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n\n              {/* Vitals */}\n              {context.vitals && Object.keys(context.vitals).length > 0 && (\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-sm font-semibold text-neutral-700 dark:text-neutral-300\">\n                    Vital Signs\n                  </h3>\n                  <div className=\"grid grid-cols-2 gap-2 text-sm text-neutral-600 dark:text-neutral-400\">\n                    {context.vitals.temperature && (\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-xs text-neutral-500\">Temp</span>\n                        <span className=\"font-medium\">\n                          {context.vitals.temperature}°C\n                        </span>\n                      </div>\n                    )}\n                    {context.vitals.heartRate && (\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-xs text-neutral-500\">HR</span>\n                        <span className=\"font-medium\">\n                          {context.vitals.heartRate} bpm\n                        </span>\n                      </div>\n                    )}\n                    {context.vitals.bloodPressure && (\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-xs text-neutral-500\">BP</span>\n                        <span className=\"font-medium\">\n                          {context.vitals.bloodPressure}\n                        </span>\n                      </div>\n                    )}\n                    {context.vitals.respiratoryRate && (\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-xs text-neutral-500\">RR</span>\n                        <span className=\"font-medium\">\n                          {context.vitals.respiratoryRate}/min\n                        </span>\n                      </div>\n                    )}\n                    {context.vitals.oxygenSaturation && (\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-xs text-neutral-500\">SpO₂</span>\n                        <span className=\"font-medium\">\n                          {context.vitals.oxygenSaturation}%\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Footer Info */}\n        <div className=\"sticky bottom-0 bg-neutral-50 dark:bg-neutral-800 border-t border-neutral-200 dark:border-neutral-700 px-4 py-3\">\n          <div className=\"flex items-start gap-2 text-xs text-neutral-600 dark:text-neutral-400\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth={1.5}\n              stroke=\"currentColor\"\n              className=\"w-4 h-4 flex-shrink-0 text-yellow-600 mt-0.5\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z\"\n              />\n            </svg>\n            <p>\n              Clinical context provides background information for AI\n              assistance. Do not enter PHI or personally identifiable\n              information.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"
}
