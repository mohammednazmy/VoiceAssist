{
  "path": "apps/web-app/src/components/templates/SaveAsTemplateDialog.tsx",
  "language": "typescript",
  "size": 8833,
  "last_modified": "2025-11-28T23:07:09.604Z",
  "lines": 293,
  "content": "/**\n * SaveAsTemplateDialog Component\n * Dialog for saving a conversation as a template\n */\n\nimport { useState, useEffect } from \"react\";\nimport { Button, Input } from \"@voiceassist/ui\";\nimport { extractErrorMessage } from \"@voiceassist/types\";\n\ninterface SaveAsTemplateDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (\n    name: string,\n    description?: string,\n    category?: string,\n    icon?: string,\n    color?: string,\n  ) => Promise<void>;\n  conversationTitle: string;\n}\n\nconst TEMPLATE_CATEGORIES = [\n  \"General\",\n  \"Clinical\",\n  \"Differential Diagnosis\",\n  \"Patient Education\",\n  \"Research\",\n  \"Documentation\",\n  \"Custom\",\n];\n\nconst TEMPLATE_ICONS = [\"üìã\", \"üìù\", \"üè•\", \"‚öïÔ∏è\", \"üíä\", \"üî¨\", \"üìä\", \"üìÅ\"];\n\nconst TEMPLATE_COLORS = [\n  { name: \"Blue\", value: \"#3B82F6\" },\n  { name: \"Green\", value: \"#10B981\" },\n  { name: \"Purple\", value: \"#8B5CF6\" },\n  { name: \"Pink\", value: \"#EC4899\" },\n  { name: \"Orange\", value: \"#F59E0B\" },\n  { name: \"Red\", value: \"#EF4444\" },\n  { name: \"Gray\", value: \"#6B7280\" },\n];\n\nexport function SaveAsTemplateDialog({\n  isOpen,\n  onClose,\n  onSave,\n  conversationTitle,\n}: SaveAsTemplateDialogProps) {\n  const [name, setName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [category, setCategory] = useState(\"General\");\n  const [icon, setIcon] = useState(\"üìã\");\n  const [color, setColor] = useState(\"#3B82F6\");\n  const [isSaving, setIsSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (isOpen) {\n      // Pre-fill with conversation title\n      setName(conversationTitle || \"\");\n      setDescription(\"\");\n      setCategory(\"General\");\n      setIcon(\"üìã\");\n      setColor(\"#3B82F6\");\n      setError(null);\n    }\n  }, [isOpen, conversationTitle]);\n\n  const handleSave = async () => {\n    if (!name.trim()) {\n      setError(\"Template name is required\");\n      return;\n    }\n\n    setIsSaving(true);\n    setError(null);\n\n    try {\n      await onSave(\n        name.trim(),\n        description.trim() || undefined,\n        category,\n        icon,\n        color,\n      );\n      onClose();\n    } catch (err: unknown) {\n      setError(extractErrorMessage(err));\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (\n      e.key === \"Enter\" &&\n      !isSaving &&\n      (e.target as HTMLElement).tagName !== \"TEXTAREA\"\n    ) {\n      handleSave();\n    } else if (e.key === \"Escape\") {\n      onClose();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div\n        className=\"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden flex flex-col\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"save-template-dialog-title\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-neutral-200\">\n          <h2\n            id=\"save-template-dialog-title\"\n            className=\"text-lg font-semibold text-neutral-900\"\n          >\n            Save as Template\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"p-1 hover:bg-neutral-100 rounded transition-colors\"\n            aria-label=\"Close dialog\"\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth={2}\n              stroke=\"currentColor\"\n              className=\"w-5 h-5 text-neutral-500\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            </svg>\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-6 space-y-4\">\n          {/* Template Name */}\n          <div>\n            <label\n              htmlFor=\"template-name\"\n              className=\"block text-sm font-medium text-neutral-700 mb-1\"\n            >\n              Template Name *\n            </label>\n            <Input\n              id=\"template-name\"\n              type=\"text\"\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder=\"Enter template name\"\n              className=\"w-full\"\n              autoFocus\n            />\n          </div>\n\n          {/* Description */}\n          <div>\n            <label\n              htmlFor=\"template-description\"\n              className=\"block text-sm font-medium text-neutral-700 mb-1\"\n            >\n              Description (Optional)\n            </label>\n            <textarea\n              id=\"template-description\"\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              placeholder=\"Describe what this template is for...\"\n              rows={3}\n              className=\"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 resize-none\"\n            />\n          </div>\n\n          {/* Category */}\n          <div>\n            <label\n              htmlFor=\"template-category\"\n              className=\"block text-sm font-medium text-neutral-700 mb-1\"\n            >\n              Category\n            </label>\n            <select\n              id=\"template-category\"\n              value={category}\n              onChange={(e) => setCategory(e.target.value)}\n              className=\"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500\"\n            >\n              {TEMPLATE_CATEGORIES.map((cat) => (\n                <option key={cat} value={cat}>\n                  {cat}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* Icon Selection */}\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-700 mb-2\">\n              Icon\n            </label>\n            <div className=\"flex gap-2 flex-wrap\">\n              {TEMPLATE_ICONS.map((i) => (\n                <button\n                  key={i}\n                  onClick={() => setIcon(i)}\n                  className={`w-10 h-10 rounded-md border-2 text-xl transition-all ${\n                    icon === i\n                      ? \"border-primary-500 bg-primary-50 scale-110\"\n                      : \"border-neutral-200 hover:border-neutral-300 hover:scale-105\"\n                  }`}\n                  aria-label={`Select ${i} icon`}\n                >\n                  {i}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Color Selection */}\n          <div>\n            <label className=\"block text-sm font-medium text-neutral-700 mb-2\">\n              Color\n            </label>\n            <div className=\"flex gap-2 flex-wrap\">\n              {TEMPLATE_COLORS.map((c) => (\n                <button\n                  key={c.value}\n                  onClick={() => setColor(c.value)}\n                  className={`w-8 h-8 rounded-full border-2 transition-all ${\n                    color === c.value\n                      ? \"border-neutral-900 scale-110\"\n                      : \"border-transparent hover:scale-105\"\n                  }`}\n                  style={{ backgroundColor: c.value }}\n                  title={c.name}\n                  aria-label={`Select ${c.name} color`}\n                />\n              ))}\n            </div>\n          </div>\n\n          {/* Error Message */}\n          {error && (\n            <div className=\"p-3 bg-red-50 border border-red-200 rounded-md\">\n              <p className=\"text-sm text-red-800\">{error}</p>\n            </div>\n          )}\n\n          {/* Info */}\n          <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-md\">\n            <p className=\"text-xs text-blue-800\">\n              This will save the current conversation's messages as a reusable\n              template. You can use this template to start new conversations\n              with the same structure.\n            </p>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex justify-end gap-3 p-6 border-t border-neutral-200\">\n          <Button onClick={onClose} variant=\"outline\" disabled={isSaving}>\n            Cancel\n          </Button>\n          <Button onClick={handleSave} disabled={isSaving || !name.trim()}>\n            {isSaving ? (\n              <>\n                <div className=\"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              \"Save Template\"\n            )}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"
}
