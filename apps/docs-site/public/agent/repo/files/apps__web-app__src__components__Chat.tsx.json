{
  "path": "apps/web-app/src/components/Chat.tsx",
  "language": "typescript",
  "size": 4588,
  "last_modified": "2025-11-29T04:27:41.402Z",
  "lines": 118,
  "content": "import { FormEvent, useState } from \"react\";\nimport { useChatSession } from \"../hooks/useChatSession\";\nimport { useToolConfirmation } from \"../hooks/useToolConfirmation\";\nimport { ToolConfirmationDialog } from \"./ToolConfirmationDialog\";\n\nexport function Chat() {\n  const [input, setInput] = useState(\"\");\n  const [conversationId] = useState<string | undefined>(\"demo-conversation\");\n  const { messages, connectionStatus, sendMessage } = useChatSession({\n    conversationId,\n  });\n  const tool = useToolConfirmation();\n  const loading =\n    connectionStatus === \"connecting\" || connectionStatus === \"reconnecting\";\n\n  const onSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    await sendMessage(input);\n    setInput(\"\");\n  };\n\n  return (\n    <section className=\"flex-1 grid grid-cols-[minmax(0,2fr)_minmax(0,1fr)]\">\n      <div className=\"flex flex-col h-full\">\n        <div className=\"px-6 py-3 border-b border-slate-800 flex items-center justify-between\">\n          <div>\n            <div className=\"text-sm font-semibold text-slate-100\">\n              Clinical conversation\n            </div>\n            <div className=\"text-xs text-slate-500\">\n              Quick consult · not connected to real PHI · demo only\n            </div>\n          </div>\n        </div>\n        <div className=\"flex-1 overflow-y-auto px-6 py-4 space-y-3 text-sm\">\n          {messages.length === 0 && (\n            <div className=\"text-slate-500 text-xs\">\n              Ask a question like:{\" \"}\n              <span className=\"italic\">\n                \"Initial management for 65M with acutely decompensated HFrEF on\n                home ACEi and beta blocker?\"\n              </span>\n            </div>\n          )}\n          {messages.map((m) => (\n            <div\n              key={m.id}\n              className=\"rounded-lg border border-slate-800 bg-slate-950/60 px-3 py-2\"\n            >\n              <div className=\"text-xs text-slate-500 mb-1\">\n                {m.role === \"assistant\" ? \"Assistant\" : \"You\"} ·{\" \"}\n                {new Date(m.timestamp).toLocaleTimeString()}\n              </div>\n              <div className=\"whitespace-pre-wrap text-slate-100\">\n                {m.content}\n              </div>\n              {m.citations && m.citations.length > 0 && (\n                <div className=\"mt-2 text-[10px] text-slate-400 space-y-1\">\n                  <div className=\"uppercase tracking-wide text-slate-500\">\n                    Sources\n                  </div>\n                  {m.citations.map((c) => (\n                    <div key={c.id}>• {c.title}</div>\n                  ))}\n                </div>\n              )}\n            </div>\n          ))}\n          {connectionStatus === \"failed\" && (\n            <div className=\"text-xs text-red-400\">Connection failed</div>\n          )}\n        </div>\n        <form\n          onSubmit={onSubmit}\n          className=\"border-t border-slate-800 px-6 py-3 flex gap-2\"\n        >\n          <input\n            className=\"flex-1 rounded-md bg-slate-950 border border-slate-700 px-3 py-2 text-sm outline-none focus:border-emerald-500\"\n            placeholder=\"Ask a focused clinical question…\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n          />\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"px-4 py-2 text-sm rounded-md bg-emerald-600 disabled:bg-emerald-900 hover:bg-emerald-500 text-white\"\n          >\n            {loading ? \"Thinking…\" : \"Send\"}\n          </button>\n        </form>\n        <ToolConfirmationDialog\n          pending={tool.pending}\n          onConfirm={tool.confirm}\n          onCancel={tool.cancel}\n        />\n      </div>\n      <aside className=\"border-l border-slate-800 bg-slate-950/60 flex flex-col\">\n        <div className=\"px-4 py-3 border-b border-slate-800\">\n          <div className=\"text-xs uppercase tracking-wide text-slate-500\">\n            Evidence\n          </div>\n          <div className=\"text-xs text-slate-400\">\n            Sources and tools will appear here as the system is implemented.\n          </div>\n        </div>\n        <div className=\"flex-1 px-4 py-3 text-xs text-slate-500 space-y-2 overflow-y-auto\">\n          <div className=\"font-semibold text-slate-300 text-sm\">Demo notes</div>\n          <p>\n            This UI is wired to the stubbed QueryOrchestrator at{\" \"}\n            <code>/api/chat/message</code>. As the backend RAG pipeline is built\n            out, this panel will show citations and tool activity.\n          </p>\n        </div>\n      </aside>\n    </section>\n  );\n}\n"
}
