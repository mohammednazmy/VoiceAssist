{
  "path": "Makefile",
  "language": null,
  "size": 5799,
  "last_modified": "2025-11-25T03:22:33.448Z",
  "lines": 184,
  "content": ".PHONY: help dev test lint type-check bandit security clean install check-env check-openai\n\n# Default target\nhelp:\n\t@echo \"VoiceAssist Development Commands\"\n\t@echo \"=================================\"\n\t@echo \"\"\n\t@echo \"Environment:\"\n\t@echo \"  make check-env     - Validate required environment variables\"\n\t@echo \"  make check-openai  - Verify OpenAI API key is valid and working\"\n\t@echo \"  make install       - Install all dependencies (backend + frontend)\"\n\t@echo \"\"\n\t@echo \"Development:\"\n\t@echo \"  make dev           - Start all services with Docker Compose\"\n\t@echo \"  make stop          - Stop all Docker Compose services\"\n\t@echo \"  make logs          - View Docker Compose logs\"\n\t@echo \"\"\n\t@echo \"Testing:\"\n\t@echo \"  make test          - Run backend unit tests (fast, no external deps)\"\n\t@echo \"  make test-unit     - Run backend unit tests only\"\n\t@echo \"  make test-e2e      - Run e2e tests (requires docker-compose stack)\"\n\t@echo \"  make test-frontend - Run frontend tests (if pnpm available)\"\n\t@echo \"\"\n\t@echo \"Quality Checks:\"\n\t@echo \"  make lint          - Run Python and frontend linters\"\n\t@echo \"  make type-check    - Run Python and TypeScript type checking\"\n\t@echo \"  make bandit        - Run Bandit security scanner\"\n\t@echo \"  make security      - Run all security scans (bandit + safety)\"\n\t@echo \"  make pre-commit    - Run pre-commit hooks on all files\"\n\t@echo \"\"\n\t@echo \"Cleanup:\"\n\t@echo \"  make clean         - Remove build artifacts and caches\"\n\t@echo \"\"\n\n# Environment validation\ncheck-env:\n\t@echo \"Checking environment configuration...\"\n\t@if [ -f scripts/check-env.sh ]; then \\\n\t\tbash scripts/check-env.sh; \\\n\telse \\\n\t\techo \"⚠️  scripts/check-env.sh not found. Skipping env validation.\"; \\\n\tfi\n\n# OpenAI API key verification\ncheck-openai:\n\t@echo \"Verifying OpenAI API key...\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\tpython ../../scripts/check_openai_key.py\n\n# Installation\ninstall: check-env\n\t@echo \"Installing backend dependencies...\"\n\t@cd services/api-gateway && \\\n\t\tif [ ! -d venv ]; then python3 -m venv venv; fi && \\\n\t\t. venv/bin/activate && \\\n\t\tpip install --upgrade pip && \\\n\t\tpip install -r requirements.txt\n\t@echo \"\"\n\t@echo \"Installing frontend dependencies...\"\n\t@if command -v pnpm >/dev/null 2>&1; then \\\n\t\tpnpm install; \\\n\telse \\\n\t\techo \"⚠️  pnpm not found. Install with: npm install -g pnpm\"; \\\n\t\techo \"    Then run: pnpm install\"; \\\n\tfi\n\n# Development\ndev: check-env\n\t@echo \"Starting Docker Compose services...\"\n\tdocker compose up -d\n\t@echo \"\"\n\t@echo \"Services started. Check status with: docker compose ps\"\n\t@echo \"View logs with: make logs\"\n\nstop:\n\t@echo \"Stopping Docker Compose services...\"\n\tdocker compose down\n\nlogs:\n\tdocker compose logs -f\n\n# Testing\ntest:\n\t@echo \"Running backend tests...\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\texport PYTHONPATH=. && \\\n\t\tpytest -v\n\ntest-unit:\n\t@echo \"Running backend unit tests...\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\texport PYTHONPATH=. && \\\n\t\tpytest -v\n\ntest-e2e:\n\t@echo \"Running e2e tests (requires docker-compose stack)...\"\n\t@echo \"Ensure services are running: make dev\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\texport PYTHONPATH=. && \\\n\t\tpytest tests/e2e/ -v || echo \"⚠️  E2E tests require full docker-compose stack to be running\"\n\ntest-frontend:\n\t@echo \"Running frontend tests...\"\n\t@if command -v pnpm >/dev/null 2>&1; then \\\n\t\tpnpm test; \\\n\telse \\\n\t\techo \"⚠️  pnpm not found. Install with: npm install -g pnpm\"; \\\n\t\texit 1; \\\n\tfi\n\n# Linting\nlint:\n\t@echo \"Running Python linting (pre-commit)...\"\n\t@pre-commit run --all-files || true\n\t@echo \"\"\n\t@echo \"Running frontend linting...\"\n\t@if command -v pnpm >/dev/null 2>&1; then \\\n\t\tpnpm lint || echo \"⚠️  Frontend linting failed or not configured\"; \\\n\telse \\\n\t\techo \"⚠️  pnpm not found. Skipping frontend lint.\"; \\\n\tfi\n\n# Type checking\ntype-check:\n\t@echo \"Running Python type checking (mypy)...\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\tif command -v mypy >/dev/null 2>&1; then \\\n\t\t\tmypy app/ || echo \"⚠️  mypy not installed or failed\"; \\\n\t\telse \\\n\t\t\techo \"⚠️  mypy not installed. Install with: pip install mypy\"; \\\n\t\tfi\n\t@echo \"\"\n\t@echo \"Running TypeScript type checking...\"\n\t@if command -v pnpm >/dev/null 2>&1; then \\\n\t\tpnpm type-check || echo \"⚠️  TypeScript type checking failed or not configured\"; \\\n\telse \\\n\t\techo \"⚠️  pnpm not found. Skipping TypeScript type check.\"; \\\n\tfi\n\n# Security scanning\nbandit:\n\t@echo \"Running Bandit security scanner...\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\tif command -v bandit >/dev/null 2>&1; then \\\n\t\t\tbandit -c ../../.bandit -r app/; \\\n\t\telse \\\n\t\t\techo \"⚠️  bandit not installed. Install with: pip install bandit\"; \\\n\t\t\texit 1; \\\n\t\tfi\n\nsecurity: bandit\n\t@echo \"\"\n\t@echo \"Running Safety dependency scanner...\"\n\t@cd services/api-gateway && \\\n\t\t. venv/bin/activate && \\\n\t\tif command -v safety >/dev/null 2>&1; then \\\n\t\t\tsafety check || echo \"⚠️  safety check failed or not installed\"; \\\n\t\telse \\\n\t\t\techo \"⚠️  safety not installed. Install with: pip install safety\"; \\\n\t\tfi\n\n# Pre-commit\npre-commit:\n\t@echo \"Running pre-commit hooks on all files...\"\n\tpre-commit run --all-files\n\n# Cleanup\nclean:\n\t@echo \"Cleaning build artifacts and caches...\"\n\tfind . -type d -name \"__pycache__\" -exec rm -rf {} + 2>/dev/null || true\n\tfind . -type d -name \"*.egg-info\" -exec rm -rf {} + 2>/dev/null || true\n\tfind . -type f -name \"*.pyc\" -delete 2>/dev/null || true\n\tfind . -type d -name \".pytest_cache\" -exec rm -rf {} + 2>/dev/null || true\n\tfind . -type d -name \".mypy_cache\" -exec rm -rf {} + 2>/dev/null || true\n\tfind . -type d -name \"htmlcov\" -exec rm -rf {} + 2>/dev/null || true\n\tfind . -type f -name \".coverage\" -delete 2>/dev/null || true\n\t@echo \"Cleanup complete.\"\n"
}
