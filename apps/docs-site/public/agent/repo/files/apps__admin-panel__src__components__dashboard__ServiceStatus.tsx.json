{
  "path": "apps/admin-panel/src/components/dashboard/ServiceStatus.tsx",
  "language": "typescript",
  "size": 1888,
  "last_modified": "2025-11-29T04:26:40.442Z",
  "lines": 58,
  "content": "import { useEffect, useState } from \"react\";\nimport { ConnectionStatus, websocketService } from \"../../services/websocket\";\n\nconst statusCopy: Record<ConnectionStatus, string> = {\n  connecting: \"Connecting\",\n  open: \"Live\",\n  reconnecting: \"Reconnecting\",\n  closed: \"Disconnected\",\n  error: \"Error\",\n};\n\nconst statusColor: Record<ConnectionStatus, string> = {\n  connecting: \"text-amber-400 border-amber-500/50 bg-amber-500/10\",\n  open: \"text-emerald-400 border-emerald-500/50 bg-emerald-500/10\",\n  reconnecting: \"text-sky-400 border-sky-500/50 bg-sky-500/10\",\n  closed: \"text-slate-400 border-slate-500/50 bg-slate-500/10\",\n  error: \"text-red-400 border-red-500/50 bg-red-500/10\",\n};\n\nexport function ServiceStatus() {\n  const [status, setStatus] = useState<ConnectionStatus>(\n    websocketService.getStatus(),\n  );\n\n  useEffect(() => {\n    const unsubscribe = websocketService.subscribeStatus(setStatus);\n    websocketService.connect();\n    return () => unsubscribe();\n  }, []);\n\n  const canReconnect = status === \"closed\" || status === \"error\";\n\n  return (\n    <div className=\"flex items-center gap-3 text-xs\">\n      <div\n        className={`inline-flex items-center gap-2 px-3 py-1 rounded-full border ${statusColor[status]}`}\n      >\n        <span className=\"h-2 w-2 rounded-full bg-current\" aria-hidden />\n        <span className=\"font-medium\">{statusCopy[status]}</span>\n      </div>\n      {status !== \"open\" && (\n        <span className=\"text-slate-400\">\n          Admin event stream{\" \"}\n          {status === \"reconnecting\" ? \"retrying\" : \"offline\"}\n        </span>\n      )}\n      {canReconnect && (\n        <button\n          onClick={() => websocketService.forceReconnect()}\n          className=\"px-3 py-1 rounded-md bg-slate-800 text-slate-200 border border-slate-700 hover:bg-slate-700 transition-colors\"\n        >\n          Retry\n        </button>\n      )}\n    </div>\n  );\n}\n"
}
