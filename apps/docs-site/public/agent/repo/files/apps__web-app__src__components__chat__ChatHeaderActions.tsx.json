{
  "path": "apps/web-app/src/components/chat/ChatHeaderActions.tsx",
  "language": "typescript",
  "size": 5101,
  "last_modified": "2025-12-03T23:50:35.642Z",
  "lines": 157,
  "content": "/**\n * ChatHeaderActions Component\n *\n * A sleek, minimal action bar with ghost-style icon buttons for chat actions.\n * Features a download dropdown for exporting conversations in different formats.\n *\n * Design principles:\n * - Ghost buttons: Transparent background, subtle hover state\n * - Muted icons: neutral-400 default, neutral-600 on hover\n * - Minimal spacing: Compact and unobtrusive\n * - Smooth transitions: Subtle hover effects\n *\n * Phase 11: VoiceAssist Voice Pipeline Sprint\n */\n\nimport { useState, useRef, useEffect } from \"react\";\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface ChatHeaderActionsProps {\n  /** Conversation ID for export */\n  conversationId: string;\n  /** Called when user selects an export format */\n  onExport: (format: \"markdown\" | \"text\") => void;\n  /** Optional: Show the existing export dialog instead of inline dropdown */\n  onOpenExportDialog?: () => void;\n}\n\n// ============================================================================\n// Icons\n// ============================================================================\n\nfunction DownloadIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      stroke=\"currentColor\"\n      strokeWidth={1.5}\n    >\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3\"\n      />\n    </svg>\n  );\n}\n\n// ============================================================================\n// Main Component\n// ============================================================================\n\nexport function ChatHeaderActions({\n  conversationId: _conversationId,\n  onExport,\n  onOpenExportDialog,\n}: ChatHeaderActionsProps) {\n  const [showExportMenu, setShowExportMenu] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu on outside click\n  useEffect(() => {\n    const handleClick = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\n        setShowExportMenu(false);\n      }\n    };\n    document.addEventListener(\"mousedown\", handleClick);\n    return () => document.removeEventListener(\"mousedown\", handleClick);\n  }, []);\n\n  // Close menu on escape\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") {\n        setShowExportMenu(false);\n      }\n    };\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, []);\n\n  const handleExportClick = () => {\n    // If we have an export dialog handler, use that instead of dropdown\n    if (onOpenExportDialog) {\n      onOpenExportDialog();\n    } else {\n      setShowExportMenu(!showExportMenu);\n    }\n  };\n\n  return (\n    <div className=\"flex items-center gap-1\" data-testid=\"chat-header-actions\">\n      {/* Export button with dropdown */}\n      <div className=\"relative\" ref={menuRef}>\n        <button\n          type=\"button\"\n          onClick={handleExportClick}\n          className=\"p-2 text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100\n                     rounded-lg transition-colors\"\n          title=\"Export conversation\"\n          aria-label=\"Export conversation\"\n          aria-expanded={showExportMenu}\n          aria-haspopup=\"menu\"\n          data-testid=\"export-dropdown-btn\"\n        >\n          <DownloadIcon className=\"w-4 h-4\" />\n        </button>\n\n        {/* Dropdown menu - appears below button */}\n        {showExportMenu && (\n          <div\n            className=\"absolute right-0 top-full mt-1 py-1 bg-white rounded-lg\n                       shadow-lg border border-neutral-200 min-w-[140px] z-20\"\n            role=\"menu\"\n            aria-label=\"Export formats\"\n            data-testid=\"export-dropdown-menu\"\n          >\n            <button\n              type=\"button\"\n              onClick={() => {\n                onExport(\"markdown\");\n                setShowExportMenu(false);\n              }}\n              className=\"w-full px-3 py-2 text-left text-sm text-neutral-700\n                         hover:bg-neutral-50 flex items-center gap-2\"\n              role=\"menuitem\"\n            >\n              <span className=\"text-xs font-mono text-neutral-400\">.md</span>\n              Markdown\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => {\n                onExport(\"text\");\n                setShowExportMenu(false);\n              }}\n              className=\"w-full px-3 py-2 text-left text-sm text-neutral-700\n                         hover:bg-neutral-50 flex items-center gap-2\"\n              role=\"menuitem\"\n            >\n              <span className=\"text-xs font-mono text-neutral-400\">.txt</span>\n              Plain Text\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default ChatHeaderActions;\n"
}
