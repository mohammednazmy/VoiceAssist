{
  "path": "apps/web-app/src/components/admin/AnalyticsDashboard.tsx",
  "language": "typescript",
  "size": 10631,
  "last_modified": "2025-11-29T04:27:41.404Z",
  "lines": 312,
  "content": "/**\n * Analytics Dashboard\n * Usage analytics, query trends, and cost tracking\n */\n\nimport { useState, useEffect } from \"react\";\n\ninterface AnalyticsData {\n  dailyConversations: number[];\n  dailyMessages: number[];\n  topQueries: Array<{ query: string; count: number }>;\n  costBreakdown: {\n    openai: number;\n    storage: number;\n    compute: number;\n  };\n  userRetention: {\n    daily: number;\n    weekly: number;\n    monthly: number;\n  };\n}\n\nexport function AnalyticsDashboard() {\n  const [analytics, setAnalytics] = useState<AnalyticsData>({\n    dailyConversations: [],\n    dailyMessages: [],\n    topQueries: [],\n    costBreakdown: {\n      openai: 0,\n      storage: 0,\n      compute: 0,\n    },\n    userRetention: {\n      daily: 0,\n      weekly: 0,\n      monthly: 0,\n    },\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [timeRange, setTimeRange] = useState<\"7d\" | \"30d\" | \"90d\">(\"7d\");\n\n  useEffect(() => {\n    loadAnalytics();\n  }, [timeRange]);\n\n  const loadAnalytics = async () => {\n    try {\n      // TODO: Replace with actual API call when backend is ready\n      // const data = await apiClient.get(`/admin/analytics?range=${timeRange}`);\n\n      // Mock data\n      const days = timeRange === \"7d\" ? 7 : timeRange === \"30d\" ? 30 : 90;\n      setAnalytics({\n        dailyConversations: Array.from(\n          { length: days },\n          () => Math.floor(Math.random() * 50) + 20,\n        ),\n        dailyMessages: Array.from(\n          { length: days },\n          () => Math.floor(Math.random() * 200) + 100,\n        ),\n        topQueries: [\n          { query: \"diabetes management guidelines\", count: 145 },\n          { query: \"hypertension treatment options\", count: 132 },\n          { query: \"chest pain differential diagnosis\", count: 98 },\n          { query: \"antibiotic selection pneumonia\", count: 87 },\n          { query: \"cardiac biomarkers interpretation\", count: 76 },\n        ],\n        costBreakdown: {\n          openai: 342.5,\n          storage: 89.2,\n          compute: 156.8,\n        },\n        userRetention: {\n          daily: 78.5,\n          weekly: 65.2,\n          monthly: 45.8,\n        },\n      });\n\n      setIsLoading(false);\n    } catch (error) {\n      console.error(\"Failed to load analytics:\", error);\n      setIsLoading(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 mx-auto mb-4 rounded-full border-4 border-primary-500 border-t-transparent animate-spin\" />\n          <p className=\"text-neutral-600\">Loading analytics...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const totalCost = Object.values(analytics.costBreakdown).reduce(\n    (a, b) => a + b,\n    0,\n  );\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-neutral-900\">\n            Analytics & Reporting\n          </h1>\n          <p className=\"text-sm text-neutral-600\">\n            Usage trends, costs, and user behavior\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <button\n            onClick={() => setTimeRange(\"7d\")}\n            className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n              timeRange === \"7d\"\n                ? \"bg-primary-500 text-white\"\n                : \"bg-neutral-100 text-neutral-700 hover:bg-neutral-200\"\n            }`}\n          >\n            7 Days\n          </button>\n          <button\n            onClick={() => setTimeRange(\"30d\")}\n            className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n              timeRange === \"30d\"\n                ? \"bg-primary-500 text-white\"\n                : \"bg-neutral-100 text-neutral-700 hover:bg-neutral-200\"\n            }`}\n          >\n            30 Days\n          </button>\n          <button\n            onClick={() => setTimeRange(\"90d\")}\n            className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n              timeRange === \"90d\"\n                ? \"bg-primary-500 text-white\"\n                : \"bg-neutral-100 text-neutral-700 hover:bg-neutral-200\"\n            }`}\n          >\n            90 Days\n          </button>\n        </div>\n      </div>\n\n      {/* Cost Overview */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <p className=\"text-sm text-neutral-600 mb-2\">\n            Total Cost ({timeRange})\n          </p>\n          <p className=\"text-3xl font-bold text-neutral-900\">\n            ${totalCost.toFixed(2)}\n          </p>\n          <p className=\"text-xs text-neutral-500 mt-1\">\n            $\n            {(\n              totalCost /\n              (timeRange === \"7d\" ? 7 : timeRange === \"30d\" ? 30 : 90)\n            ).toFixed(2)}\n            /day avg\n          </p>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <p className=\"text-sm text-neutral-600 mb-2\">OpenAI API</p>\n          <p className=\"text-3xl font-bold text-blue-600\">\n            ${analytics.costBreakdown.openai.toFixed(2)}\n          </p>\n          <p className=\"text-xs text-neutral-500 mt-1\">\n            {((analytics.costBreakdown.openai / totalCost) * 100).toFixed(1)}%\n            of total\n          </p>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <p className=\"text-sm text-neutral-600 mb-2\">Storage</p>\n          <p className=\"text-3xl font-bold text-green-600\">\n            ${analytics.costBreakdown.storage.toFixed(2)}\n          </p>\n          <p className=\"text-xs text-neutral-500 mt-1\">\n            {((analytics.costBreakdown.storage / totalCost) * 100).toFixed(1)}%\n            of total\n          </p>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <p className=\"text-sm text-neutral-600 mb-2\">Compute</p>\n          <p className=\"text-3xl font-bold text-purple-600\">\n            ${analytics.costBreakdown.compute.toFixed(2)}\n          </p>\n          <p className=\"text-xs text-neutral-500 mt-1\">\n            {((analytics.costBreakdown.compute / totalCost) * 100).toFixed(1)}%\n            of total\n          </p>\n        </div>\n      </div>\n\n      {/* User Retention */}\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h2 className=\"text-lg font-semibold text-neutral-900 mb-4\">\n          User Retention\n        </h2>\n        <div className=\"grid grid-cols-3 gap-4\">\n          <div className=\"text-center\">\n            <p className=\"text-sm text-neutral-600 mb-2\">Daily Active Users</p>\n            <p className=\"text-4xl font-bold text-green-600\">\n              {analytics.userRetention.daily}%\n            </p>\n          </div>\n          <div className=\"text-center\">\n            <p className=\"text-sm text-neutral-600 mb-2\">Weekly Active Users</p>\n            <p className=\"text-4xl font-bold text-blue-600\">\n              {analytics.userRetention.weekly}%\n            </p>\n          </div>\n          <div className=\"text-center\">\n            <p className=\"text-sm text-neutral-600 mb-2\">\n              Monthly Active Users\n            </p>\n            <p className=\"text-4xl font-bold text-purple-600\">\n              {analytics.userRetention.monthly}%\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Usage Trends (Placeholder for Charts) */}\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h2 className=\"text-lg font-semibold text-neutral-900 mb-4\">\n          Usage Trends\n        </h2>\n        <div className=\"text-center py-12 text-neutral-500\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1.5}\n            stroke=\"currentColor\"\n            className=\"w-12 h-12 mx-auto mb-3\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              d=\"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z\"\n            />\n          </svg>\n          <p className=\"text-sm mb-2\">Interactive charts coming soon</p>\n          <p className=\"text-xs text-neutral-400\">\n            Install chart library (e.g., recharts, chart.js) for visualization\n          </p>\n        </div>\n      </div>\n\n      {/* Top Queries */}\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h2 className=\"text-lg font-semibold text-neutral-900 mb-4\">\n          Top Queries\n        </h2>\n        <div className=\"space-y-3\">\n          {analytics.topQueries.map((query, index) => (\n            <div key={index} className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-3\">\n                <span className=\"flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 text-neutral-600 text-xs font-medium\">\n                  {index + 1}\n                </span>\n                <span className=\"text-sm text-neutral-900\">{query.query}</span>\n              </div>\n              <span className=\"text-sm font-medium text-neutral-600\">\n                {query.count}\n              </span>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Export Button */}\n      <div className=\"flex justify-end\">\n        <button\n          onClick={() =>\n            alert(\n              \"Export functionality will be available when backend is ready\",\n            )\n          }\n          className=\"flex items-center space-x-2 px-4 py-2 text-sm font-medium text-white bg-primary-500 rounded-md hover:bg-primary-600 transition-colors\"\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={2}\n            stroke=\"currentColor\"\n            className=\"w-4 h-4\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              d=\"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3\"\n            />\n          </svg>\n          <span>Export Report</span>\n        </button>\n      </div>\n    </div>\n  );\n}\n"
}
