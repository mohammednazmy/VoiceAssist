{
  "path": "apps/web-app/src/components/chat/ConnectionStatus.tsx",
  "language": "typescript",
  "size": 4961,
  "last_modified": "2025-11-26T12:05:20.902Z",
  "lines": 186,
  "content": "/**\n * ConnectionStatus Component\n * Displays WebSocket connection status with visual indicators and reconnect functionality\n */\n\nimport type { ConnectionStatus as Status } from \"@voiceassist/types\";\n\nexport interface ConnectionStatusProps {\n  status: Status;\n  onReconnect?: () => void;\n  /** Compact mode for inline display near input */\n  compact?: boolean;\n}\n\n// Spinner icon for connecting/reconnecting states\nconst SpinnerIcon = () => (\n  <svg\n    className=\"w-3 h-3 animate-spin\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n  >\n    <circle\n      className=\"opacity-25\"\n      cx=\"12\"\n      cy=\"12\"\n      r=\"10\"\n      stroke=\"currentColor\"\n      strokeWidth=\"4\"\n    />\n    <path\n      className=\"opacity-75\"\n      fill=\"currentColor\"\n      d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n    />\n  </svg>\n);\n\n// Retry icon\nconst RetryIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    strokeWidth={2}\n    stroke=\"currentColor\"\n    className=\"w-3 h-3\"\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99\"\n    />\n  </svg>\n);\n\nexport function ConnectionStatus({\n  status,\n  onReconnect,\n  compact = false,\n}: ConnectionStatusProps) {\n  const statusConfig: Record<\n    Status,\n    {\n      label: string;\n      color: string;\n      bgColor: string;\n      borderColor: string;\n      icon: React.ReactNode;\n      showRetry?: boolean;\n    }\n  > = {\n    connecting: {\n      label: \"Connecting\",\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50\",\n      borderColor: \"border-yellow-200\",\n      icon: <SpinnerIcon />,\n    },\n    connected: {\n      label: \"Connected\",\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50\",\n      borderColor: \"border-green-200\",\n      icon: <div className=\"w-2 h-2 rounded-full bg-green-500\" />,\n    },\n    reconnecting: {\n      label: \"Reconnecting\",\n      color: \"text-orange-600\",\n      bgColor: \"bg-orange-50\",\n      borderColor: \"border-orange-200\",\n      icon: <SpinnerIcon />,\n    },\n    disconnected: {\n      label: \"Disconnected\",\n      color: \"text-red-600\",\n      bgColor: \"bg-red-50\",\n      borderColor: \"border-red-200\",\n      icon: <div className=\"w-2 h-2 rounded-full bg-red-500\" />,\n      showRetry: true,\n    },\n    failed: {\n      label: \"Connection Failed\",\n      color: \"text-red-700\",\n      bgColor: \"bg-red-100\",\n      borderColor: \"border-red-300\",\n      icon: (\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          strokeWidth={2}\n          stroke=\"currentColor\"\n          className=\"w-3 h-3\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            d=\"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z\"\n          />\n        </svg>\n      ),\n      showRetry: true,\n    },\n  };\n\n  const config = statusConfig[status] || statusConfig.disconnected;\n\n  // Compact version for inline display\n  if (compact) {\n    if (status === \"connected\") {\n      return null; // Don't show when connected in compact mode\n    }\n\n    return (\n      <div\n        className={`inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs ${config.color}`}\n        role=\"status\"\n        aria-live=\"polite\"\n        aria-label={`Connection status: ${config.label}`}\n      >\n        {config.icon}\n        <span className=\"font-medium\">{config.label}</span>\n        {config.showRetry && onReconnect && (\n          <button\n            type=\"button\"\n            onClick={onReconnect}\n            className=\"ml-1 inline-flex items-center gap-1 px-1.5 py-0.5 text-xs font-medium text-red-700 hover:text-red-800 bg-red-100 hover:bg-red-200 rounded transition-colors\"\n            aria-label=\"Reconnect to chat\"\n          >\n            <RetryIcon />\n            Retry\n          </button>\n        )}\n      </div>\n    );\n  }\n\n  // Full version for header display\n  return (\n    <div\n      className={`inline-flex items-center gap-2 px-3 py-1.5 rounded-full border ${config.bgColor} ${config.borderColor}`}\n      role=\"status\"\n      aria-live=\"polite\"\n      aria-label={`Connection status: ${config.label}`}\n    >\n      {config.icon}\n      <span className={`text-xs font-medium ${config.color}`}>\n        {config.label}\n      </span>\n\n      {config.showRetry && onReconnect && (\n        <button\n          type=\"button\"\n          onClick={onReconnect}\n          className=\"ml-1 inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded-full transition-colors\"\n          aria-label=\"Reconnect to chat\"\n        >\n          <RetryIcon />\n          Retry\n        </button>\n      )}\n    </div>\n  );\n}\n"
}
