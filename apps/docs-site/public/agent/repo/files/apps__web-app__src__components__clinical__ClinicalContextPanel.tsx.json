{
  "path": "apps/web-app/src/components/clinical/ClinicalContextPanel.tsx",
  "language": "typescript",
  "size": 12546,
  "last_modified": "2025-11-29T04:23:40.127Z",
  "lines": 409,
  "content": "/**\n * Clinical Context Panel\n * Capture patient demographics, problems, medications, labs, and vitals\n */\n\nimport { useState } from \"react\";\nimport { Label, Input, Button } from \"@voiceassist/ui\";\n\nexport interface ClinicalContext {\n  demographics?: {\n    age?: number;\n    gender?: string;\n    weight?: number;\n    height?: number;\n  };\n  chiefComplaint?: string;\n  problems?: string[];\n  medications?: string[];\n  allergies?: string[];\n  vitals?: {\n    temperature?: number;\n    heartRate?: number;\n    bloodPressure?: string;\n    respiratoryRate?: number;\n    oxygenSaturation?: number;\n  };\n  labs?: Array<{\n    name: string;\n    value: string;\n    unit?: string;\n  }>;\n}\n\ninterface ClinicalContextPanelProps {\n  context: ClinicalContext;\n  onChange: (context: ClinicalContext) => void;\n  onClear?: () => void;\n}\n\nexport function ClinicalContextPanel({\n  context,\n  onChange,\n  onClear,\n}: ClinicalContextPanelProps) {\n  const [activeSection, setActiveSection] = useState<string>(\"demographics\");\n\n  const updateDemographics = (field: string, value: any) => {\n    onChange({\n      ...context,\n      demographics: {\n        ...context.demographics,\n        [field]: value,\n      },\n    });\n  };\n\n  const updateVitals = (field: string, value: any) => {\n    onChange({\n      ...context,\n      vitals: {\n        ...context.vitals,\n        [field]: value,\n      },\n    });\n  };\n\n  const addItem = (\n    field: \"problems\" | \"medications\" | \"allergies\",\n    value: string,\n  ) => {\n    if (!value.trim()) return;\n\n    onChange({\n      ...context,\n      [field]: [...(context[field] || []), value.trim()],\n    });\n  };\n\n  const removeItem = (\n    field: \"problems\" | \"medications\" | \"allergies\",\n    index: number,\n  ) => {\n    onChange({\n      ...context,\n      [field]: (context[field] || []).filter((_, i) => i !== index),\n    });\n  };\n\n  const hasContext = Object.keys(context).some((key) => {\n    const value = context[key as keyof ClinicalContext];\n    if (Array.isArray(value)) return value.length > 0;\n    if (typeof value === \"object\") return Object.keys(value).length > 0;\n    return Boolean(value);\n  });\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-lg font-semibold text-neutral-900\">\n          Clinical Context\n        </h2>\n        {hasContext && (\n          <Button variant=\"ghost\" size=\"sm\" onClick={onClear}>\n            Clear All\n          </Button>\n        )}\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex space-x-1 border-b border-neutral-200\">\n        {[\n          { id: \"demographics\", label: \"Demographics\" },\n          { id: \"problems\", label: \"Problems\" },\n          { id: \"medications\", label: \"Medications\" },\n          { id: \"vitals\", label: \"Vitals\" },\n        ].map((tab) => (\n          <button\n            key={tab.id}\n            onClick={() => setActiveSection(tab.id)}\n            className={`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${\n              activeSection === tab.id\n                ? \"border-primary-500 text-primary-600\"\n                : \"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300\"\n            }`}\n          >\n            {tab.label}\n          </button>\n        ))}\n      </div>\n\n      {/* Content */}\n      <div className=\"py-4\">\n        {/* Demographics */}\n        {activeSection === \"demographics\" && (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"age\">Age</Label>\n                <Input\n                  id=\"age\"\n                  type=\"number\"\n                  placeholder=\"e.g., 45\"\n                  value={context.demographics?.age || \"\"}\n                  onChange={(e) =>\n                    updateDemographics(\n                      \"age\",\n                      parseInt(e.target.value) || undefined,\n                    )\n                  }\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"gender\">Gender</Label>\n                <select\n                  id=\"gender\"\n                  value={context.demographics?.gender || \"\"}\n                  onChange={(e) => updateDemographics(\"gender\", e.target.value)}\n                  className=\"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500\"\n                >\n                  <option value=\"\">Select...</option>\n                  <option value=\"male\">Male</option>\n                  <option value=\"female\">Female</option>\n                  <option value=\"other\">Other</option>\n                </select>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"weight\">Weight (kg)</Label>\n                <Input\n                  id=\"weight\"\n                  type=\"number\"\n                  step=\"0.1\"\n                  placeholder=\"e.g., 70.5\"\n                  value={context.demographics?.weight || \"\"}\n                  onChange={(e) =>\n                    updateDemographics(\n                      \"weight\",\n                      parseFloat(e.target.value) || undefined,\n                    )\n                  }\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"height\">Height (cm)</Label>\n                <Input\n                  id=\"height\"\n                  type=\"number\"\n                  step=\"0.1\"\n                  placeholder=\"e.g., 175\"\n                  value={context.demographics?.height || \"\"}\n                  onChange={(e) =>\n                    updateDemographics(\n                      \"height\",\n                      parseFloat(e.target.value) || undefined,\n                    )\n                  }\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"chiefComplaint\">Chief Complaint</Label>\n              <textarea\n                id=\"chiefComplaint\"\n                rows={3}\n                placeholder=\"Patient's primary concern...\"\n                value={context.chiefComplaint || \"\"}\n                onChange={(e) =>\n                  onChange({ ...context, chiefComplaint: e.target.value })\n                }\n                className=\"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500\"\n              />\n            </div>\n          </div>\n        )}\n\n        {/* Problems */}\n        {activeSection === \"problems\" && (\n          <ItemList\n            title=\"Active Problems\"\n            items={context.problems || []}\n            placeholder=\"e.g., Type 2 Diabetes, Hypertension\"\n            onAdd={(value) => addItem(\"problems\", value)}\n            onRemove={(index) => removeItem(\"problems\", index)}\n          />\n        )}\n\n        {/* Medications */}\n        {activeSection === \"medications\" && (\n          <ItemList\n            title=\"Current Medications\"\n            items={context.medications || []}\n            placeholder=\"e.g., Metformin 500mg BID, Lisinopril 10mg daily\"\n            onAdd={(value) => addItem(\"medications\", value)}\n            onRemove={(index) => removeItem(\"medications\", index)}\n          />\n        )}\n\n        {/* Vitals */}\n        {activeSection === \"vitals\" && (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"temperature\">Temperature (Â°C)</Label>\n                <Input\n                  id=\"temperature\"\n                  type=\"number\"\n                  step=\"0.1\"\n                  placeholder=\"e.g., 37.2\"\n                  value={context.vitals?.temperature || \"\"}\n                  onChange={(e) =>\n                    updateVitals(\n                      \"temperature\",\n                      parseFloat(e.target.value) || undefined,\n                    )\n                  }\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"heartRate\">Heart Rate (bpm)</Label>\n                <Input\n                  id=\"heartRate\"\n                  type=\"number\"\n                  placeholder=\"e.g., 72\"\n                  value={context.vitals?.heartRate || \"\"}\n                  onChange={(e) =>\n                    updateVitals(\n                      \"heartRate\",\n                      parseInt(e.target.value) || undefined,\n                    )\n                  }\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"bloodPressure\">Blood Pressure (mmHg)</Label>\n                <Input\n                  id=\"bloodPressure\"\n                  type=\"text\"\n                  placeholder=\"e.g., 120/80\"\n                  value={context.vitals?.bloodPressure || \"\"}\n                  onChange={(e) =>\n                    updateVitals(\"bloodPressure\", e.target.value)\n                  }\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"respiratoryRate\">\n                  Respiratory Rate (breaths/min)\n                </Label>\n                <Input\n                  id=\"respiratoryRate\"\n                  type=\"number\"\n                  placeholder=\"e.g., 16\"\n                  value={context.vitals?.respiratoryRate || \"\"}\n                  onChange={(e) =>\n                    updateVitals(\n                      \"respiratoryRate\",\n                      parseInt(e.target.value) || undefined,\n                    )\n                  }\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"oxygenSaturation\">Oxygen Saturation (%)</Label>\n              <Input\n                id=\"oxygenSaturation\"\n                type=\"number\"\n                placeholder=\"e.g., 98\"\n                value={context.vitals?.oxygenSaturation || \"\"}\n                onChange={(e) =>\n                  updateVitals(\n                    \"oxygenSaturation\",\n                    parseInt(e.target.value) || undefined,\n                  )\n                }\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// Helper component for lists\nfunction ItemList({\n  items,\n  placeholder,\n  onAdd,\n  onRemove,\n}: {\n  title: string;\n  items: string[];\n  placeholder: string;\n  onAdd: (value: string) => void;\n  onRemove: (index: number) => void;\n}) {\n  const [inputValue, setInputValue] = useState(\"\");\n\n  const handleAdd = () => {\n    onAdd(inputValue);\n    setInputValue(\"\");\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex space-x-2\">\n        <Input\n          placeholder={placeholder}\n          value={inputValue}\n          onChange={(e) => setInputValue(e.target.value)}\n          onKeyPress={(e) => {\n            if (e.key === \"Enter\") {\n              e.preventDefault();\n              handleAdd();\n            }\n          }}\n          className=\"flex-1\"\n        />\n        <Button onClick={handleAdd} disabled={!inputValue.trim()}>\n          Add\n        </Button>\n      </div>\n\n      {items.length > 0 && (\n        <ul className=\"space-y-2\">\n          {items.map((item, index) => (\n            <li\n              key={index}\n              className=\"flex items-center justify-between p-3 bg-neutral-50 rounded-md border border-neutral-200\"\n            >\n              <span className=\"text-sm text-neutral-900\">{item}</span>\n              <button\n                type=\"button\"\n                onClick={() => onRemove(index)}\n                className=\"text-neutral-400 hover:text-red-600 focus:outline-none\"\n                aria-label={`Remove ${item}`}\n              >\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  strokeWidth={2}\n                  stroke=\"currentColor\"\n                  className=\"w-5 h-5\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    d=\"M6 18L18 6M6 6l12 12\"\n                  />\n                </svg>\n              </button>\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n"
}
