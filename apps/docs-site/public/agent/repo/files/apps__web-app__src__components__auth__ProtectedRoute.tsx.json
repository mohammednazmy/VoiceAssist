{
  "path": "apps/web-app/src/components/auth/ProtectedRoute.tsx",
  "language": "typescript",
  "size": 1639,
  "last_modified": "2025-11-25T09:43:39.262Z",
  "lines": 55,
  "content": "/**\n * Protected Route Component\n * Redirects to login if user is not authenticated\n * Waits for Zustand persist hydration to complete before checking auth\n */\n\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuthStore } from \"../../stores/authStore\";\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n}\n\nexport function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const { isAuthenticated, isLoading, _hasHydrated } = useAuthStore();\n  const location = useLocation();\n\n  // Debug logging for E2E tests\n  if (typeof window !== \"undefined\" && process.env.NODE_ENV === \"development\") {\n    console.log(\"[ProtectedRoute] State:\", {\n      isAuthenticated,\n      isLoading,\n      _hasHydrated,\n      path: location.pathname,\n    });\n  }\n\n  // Wait for Zustand persist to hydrate from localStorage\n  // This prevents premature redirects before auth state is loaded\n  if (!_hasHydrated) {\n    console.log(\"[ProtectedRoute] Waiting for hydration...\");\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500\" />\n      </div>\n    );\n  }\n\n  // Show loading state while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500\" />\n      </div>\n    );\n  }\n\n  // Redirect to login if not authenticated\n  if (!isAuthenticated) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  return <>{children}</>;\n}\n"
}
