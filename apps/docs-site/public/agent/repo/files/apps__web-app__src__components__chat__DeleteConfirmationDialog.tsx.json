{
  "path": "apps/web-app/src/components/chat/DeleteConfirmationDialog.tsx",
  "language": "typescript",
  "size": 5512,
  "last_modified": "2025-11-29T04:22:45.089Z",
  "lines": 171,
  "content": "/**\n * DeleteConfirmationDialog Component\n * Confirmation dialog for message deletion with preview and loading state\n *\n * Features:\n * - Dark mode styling consistent with app theme\n * - Message content preview (truncated)\n * - Loading state during deletion\n * - Keyboard support (Escape to cancel)\n */\n\nimport { useEffect, useCallback } from \"react\";\n\nexport interface DeleteConfirmationDialogProps {\n  /** Whether the dialog is open */\n  isOpen: boolean;\n  /** The message content to preview (will be truncated) */\n  messageContent: string;\n  /** Whether the message is from user or assistant */\n  messageRole: \"user\" | \"assistant\";\n  /** Called when deletion is confirmed */\n  onConfirm: () => void;\n  /** Called when deletion is cancelled */\n  onCancel: () => void;\n  /** Whether deletion is in progress */\n  isDeleting?: boolean;\n}\n\nconst MAX_PREVIEW_LENGTH = 150;\n\nfunction truncateMessage(content: string): string {\n  if (content.length <= MAX_PREVIEW_LENGTH) {\n    return content;\n  }\n  return content.slice(0, MAX_PREVIEW_LENGTH) + \"...\";\n}\n\nexport function DeleteConfirmationDialog({\n  isOpen,\n  messageContent,\n  messageRole,\n  onConfirm,\n  onCancel,\n  isDeleting = false,\n}: DeleteConfirmationDialogProps) {\n  // Handle Escape key to cancel\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === \"Escape\" && !isDeleting) {\n        onCancel();\n      }\n    },\n    [onCancel, isDeleting],\n  );\n\n  useEffect(() => {\n    if (isOpen) {\n      document.addEventListener(\"keydown\", handleKeyDown);\n      return () => document.removeEventListener(\"keydown\", handleKeyDown);\n    }\n  }, [isOpen, handleKeyDown]);\n\n  if (!isOpen) return null;\n\n  const roleLabel =\n    messageRole === \"user\" ? \"Your message\" : \"Assistant message\";\n\n  return (\n    <div\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\n      onClick={(e) => {\n        // Close on backdrop click if not deleting\n        if (e.target === e.currentTarget && !isDeleting) {\n          onCancel();\n        }\n      }}\n      data-testid=\"delete-confirmation-dialog\"\n    >\n      <div\n        className=\"bg-slate-900 border border-slate-700 rounded-xl shadow-xl max-w-md w-full mx-4 p-5 space-y-4\"\n        role=\"alertdialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"delete-dialog-title\"\n        aria-describedby=\"delete-dialog-description\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center gap-2\">\n          <div className=\"p-2 rounded-full bg-red-500/10\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth={1.5}\n              stroke=\"currentColor\"\n              className=\"w-5 h-5 text-red-500\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z\"\n              />\n            </svg>\n          </div>\n          <h2\n            id=\"delete-dialog-title\"\n            className=\"text-base font-semibold text-slate-100\"\n          >\n            Delete message?\n          </h2>\n        </div>\n\n        {/* Description */}\n        <p id=\"delete-dialog-description\" className=\"text-sm text-slate-400\">\n          This action cannot be undone. The message will be permanently removed\n          from this conversation.\n        </p>\n\n        {/* Message Preview */}\n        <div className=\"bg-slate-950 border border-slate-800 rounded-lg p-3\">\n          <div className=\"text-xs text-slate-500 mb-1\">{roleLabel}</div>\n          <p className=\"text-sm text-slate-300 break-words\">\n            {truncateMessage(messageContent)}\n          </p>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end gap-3 pt-2\">\n          <button\n            onClick={onCancel}\n            disabled={isDeleting}\n            className=\"px-4 py-2 text-sm rounded-lg border border-slate-700 text-slate-300 hover:bg-slate-800 hover:text-slate-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            data-testid=\"delete-cancel-button\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={onConfirm}\n            disabled={isDeleting}\n            className=\"px-4 py-2 text-sm rounded-lg bg-red-600 hover:bg-red-500 text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n            data-testid=\"delete-confirm-button\"\n          >\n            {isDeleting && (\n              <svg\n                className=\"w-4 h-4 animate-spin\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n              >\n                <circle\n                  className=\"opacity-25\"\n                  cx=\"12\"\n                  cy=\"12\"\n                  r=\"10\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"4\"\n                />\n                <path\n                  className=\"opacity-75\"\n                  fill=\"currentColor\"\n                  d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                />\n              </svg>\n            )}\n            {isDeleting ? \"Deleting...\" : \"Delete\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"
}
